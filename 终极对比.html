<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Textbook vs Real-life Expressions!</title>
    <style>
        :root {
            --std: #4a90e2; --col: #f5a623; --pinyin: #d0021b; 
            --reply: #673ab7; --bg: #f8f9fa; --success: #4caf50; --gold: #fbc02d;
            --night-sky: radial-gradient(circle at center, #001f3f 0%, #000510 100%);
        }
        body { margin: 0; font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif; background: var(--bg); touch-action: manipulation; overflow-x: hidden; }
        
        /* é‡‘å…‰æµæ˜Ÿå°é¢ */
        #cover-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--night-sky); z-index: 9999; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease;
        }
        .star {
            position: absolute; top: 50%; left: 50%; width: 2px; height: 2px;
            background: white; border-radius: 50%; box-shadow: 0 0 10px #fff;
            animation: shoot linear infinite;
        }
        @keyframes shoot {
            0% { transform: translate(-50%, -50%) rotate(var(--angle)) translateX(0); opacity: 1; }
            100% { transform: translate(-50%, -50%) rotate(var(--angle)) translateX(1000px); opacity: 0; width: 160px; }
        }
        .cover-content { text-align: center; z-index: 10; padding: 20px; pointer-events: none; }
        .cover-title { font-size: 8vw; color: var(--gold); line-height: 1.1; margin: 0; font-weight: 900; text-shadow: 0 0 30px rgba(251,192,45,0.8); }
        .cover-subtitle { font-size: 4vw; color: white; margin-top: 15px; font-weight: bold; letter-spacing: 2px; }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.7; transform: scale(1.05); } }

        /* å¯¼èˆªä¸ä¸»å¸ƒå±€ */
        nav { background: white; padding: 10px; display: flex; justify-content: center; gap: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        nav button { padding: 10px 18px; border: none; border-radius: 20px; cursor: pointer; font-size: 14px; font-weight: bold; background: #eee; transition: 0.3s; }
        nav button.active-tab { background: var(--std); color: white; }

        main { padding: 15px; max-width: 800px; margin: 0 auto; min-height: 100vh; }
        .view { display: none; }
        .view.active { display: block; }

        .card-wrap { background: white; border-radius: 24px; padding: 20px; margin-bottom: 30px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); border: 1px solid #f0f0f0; animation: fadeIn 0.5s; }
        .box { margin-bottom: 12px; padding: 16px; border-radius: 18px; cursor: pointer; transition: 0.2s; border-left: 8px solid #ddd; position: relative; }
        .box:active { transform: scale(0.98); }
        .std-box { border-color: var(--std); background: #f0f7ff; }
        .col-box { border-color: var(--col); background: #fff8ee; }
        .reply-box { border-color: var(--reply); background: #f3eaff; display: none; margin-top: 10px; animation: slideIn 0.3s ease-out; }

        ruby { font-size: 26px; font-weight: 700; line-height: 2.4; margin-right: 4px; }
        rt { font-size: 13px; color: var(--pinyin); font-weight: bold; }
        .eng-sub { display: block; font-size: 15px; color: #555; font-style: italic; margin-top: 5px; border-top: 1px dashed #ccc; padding-top: 5px; }

        .btn-reply { width: 100%; padding: 12px; border: 2px dashed var(--reply); border-radius: 15px; background: none; color: var(--reply); font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn-reply:hover { background: var(--reply); color: white; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>

<div id="cover-page" onclick="enterApp()">
    <div id="star-container"></div>
    <div class="cover-content">
        <h1 class="cover-title">Textbook vs Real-life Expressions!</h1>
        <div class="cover-subtitle">SPEAK CHINESE LIKE A NATIVE</div>
        <p style="color:var(--gold); margin-top:40px; font-weight:bold; animation: pulse 1.2s infinite; font-size: 22px;">[ TAP TO START ]</p>
    </div>
</div>

<nav>
    <button id="tab-study" class="active-tab" onclick="showTab('study')">ğŸ“– Study</button>
    <button id="tab-list" onclick="showTab('list')">ğŸ“œ Bank</button>
    <button id="tab-quiz" onclick="showTab('quiz')">âš¡ Rush</button>
</nav>

<main>
    <div id="view-study" class="view active"></div>
    <div id="view-list" class="view"></div>
    <div id="view-quiz" class="view" style="text-align: center;">
        <div id="timer" style="font-size: 40px; color: var(--pinyin); font-weight: 900; margin-bottom: 20px;">30s</div>
        <div id="quiz-card"></div>
        <div id="quiz-options"></div>
    </div>
</main>

<script>
    const data = [
        { st: "è¯·é—®æ‚¨è´µå§“ï¼Ÿ", stp: "qÇng wÃ¨n nÃ­n guÃ¬ xÃ¬ng", ste: "What's your surname?", cl: "æ€ä¹ˆç§°å‘¼æ‚¨ï¼Ÿ", clp: "zÄ›n me chÄ“ng hu nÃ­n", cle: "How should I call you?", cr: "å«æˆ‘è€ç‹å°±è¡Œã€‚", crp: "jiÃ o wÇ’ lÇo wÃ¡ng jiÃ¹ xÃ­ng", cre: "Just call me Lao Wang." },
        { st: "å¸Œæœ›èƒ½ä¸æ‚¨åˆä½œã€‚", stp: "xÄ« wÃ ng nÃ©ng yÇ” nÃ­n hÃ© zuÃ²", ste: "Hope to cooperate.", cl: "åŠ ä¸ªå¾®ä¿¡å§ã€‚", clp: "jiÄ ge wÄ“i xÃ¬n ba", cle: "Let's add WeChat.", cr: "è¡Œï¼Œæˆ‘æ‰«ä½ å§ã€‚", crp: "xÃ­ng , wÇ’ sÇo nÇ ba", cre: "Sure, I'll scan you." },
        { st: "æˆ‘ä»¬å»åƒé¥­å§ï¼Ÿ", stp: "wÇ’ men qÃ¹ chÄ« fÃ n ba", ste: "Shall we go eat?", cl: "èµ°ï¼Œå¹²é¥­å»ï¼", clp: "zÇ’u , gÃ n fÃ n qÃ¹", cle: "Let's go grab food!", cr: "èµ°èµ·ï¼Œé¥¿æ­»äº†ã€‚", crp: "zÇ’u qÇ , Ã¨ sÇ le", cre: "Let's go, I'm starving." },
        { st: "æ‚¨å»å“ªå„¿ï¼Ÿ", stp: "nÃ­n qÃ¹ nÇ r", ste: "Where are you going?", cl: "å»å“ªå„¿æ··å‘€ï¼Ÿ", clp: "qÃ¹ nÇ r hÃ¹n ya", cle: "Where are you heading?", cr: "å…¬å¸åŠ ç­ï¼Œå‘½è‹¦ã€‚", crp: "gÅng sÄ« jiÄ bÄn , mÃ¬ng kÇ”", cre: "Office overtime, so unlucky." },
        { st: "å¤ªæ„Ÿè°¢ä½ äº†ã€‚", stp: "tÃ i gÇn xiÃ¨ nÇ le", ste: "Thank you so much.", cl: "è°¢äº†å•Šï¼Œå¤Ÿæ„æ€ï¼", clp: "xiÃ¨ le a , gÃ²u yÃ¬ si", cle: "Thanks! You're real!", cr: "å°äº‹å„¿ï¼Œå®¢æ°”å•¥ã€‚", crp: "xiÇo shÃ¬r , kÃ¨ qi shÃ¡", cre: "Small thing, don't mention it." },
        { st: "å¯¹ä¸èµ·ï¼Œæˆ‘è¿Ÿåˆ°äº†ã€‚", stp: "duÃ¬ bÃ¹ qÇ , wÇ’ chÃ­ dÃ o le", ste: "Sorry for being late.", cl: "æŠ±æ­‰ï¼Œè·¯ä¸Šå µæ­»äº†ã€‚", clp: "bÃ o qiÃ n , lÃ¹ shang dÇ” sÇ le", cle: "Sorry, traffic was deadly.", cr: "æ²¡äº‹ï¼Œæˆ‘ä¹Ÿåˆšåˆ°ã€‚", crp: "mÃ©i shÃ¬ , wÇ’ yÄ› gÄng dÃ o", cre: "It's fine, I just got here." },
        { st: "é‚£ä¸ªä¸œè¥¿å¤šå°‘é’±ï¼Ÿ", stp: "nÃ  ge dÅng xi duÅ shao qiÃ¡n", ste: "How much is that?", cl: "è¿™æ€ä¹ˆå–ï¼Ÿ", clp: "zhÃ¨ zÄ›n me mÃ i", cle: "How is this sold?", cr: "ç»™åå—æ‹¿èµ°å§ã€‚", crp: "gÄ›i shÃ­ kuÃ i nÃ¡ zÇ’u ba", cre: "Give me 10 and take it." },
        { st: "å†è§ï¼Œæˆ‘èµ°äº†ã€‚", stp: "zÃ i jiÃ n , wÇ’ zÇ’u le", ste: "Goodbye, I'm going.", cl: "å…ˆæºœäº†ï¼Œå›è§ï¼", clp: "xiÄn liÅ« le , huÃ­ jiÃ n", cle: "Slipping away now, see ya!", cr: "è¡Œï¼Œè·¯ä¸Šæ…¢ç‚¹å„¿ã€‚", crp: "xÃ­ng , lÃ¹ shang mÃ n diÇnr", cre: "OK, take it easy on the way." },
        { st: "ä½ æ˜ç™½äº†å—ï¼Ÿ", stp: "nÇ mÃ­ng bai le ma", ste: "Do you understand?", cl: "æ‡‚æˆ‘æ„æ€å—ï¼Ÿ", clp: "nÇ dÇ’ng wÇ’ yÃ¬ si ma", cle: "You get my point?", cr: "ç§’æ‡‚ã€‚", crp: "miÇo dÇ’ng", cre: "Got it instantly." },
        { st: "ä½ åœ¨åšä»€ä¹ˆï¼Ÿ", stp: "nÇ zÃ i zuÃ² shÃ©n me", ste: "What are you doing?", cl: "å¿™å•¥å‘¢ï¼Ÿ", clp: "mÃ¡ng shÃ¡ ne", cle: "What's up?", cr: "çå¿™ï¼Œæ²¡å¹²å•¥ã€‚", crp: "xiÄ mÃ¡ng , mÃ©i gÃ n shÃ¡", cre: "Just busy with nothing." },
        { st: "è¿™å¤©æ°”å¤ªçƒ­äº†ã€‚", stp: "zhÃ¨ tiÄn qÃ¬ tÃ i rÃ¨ le", ste: "Weather is too hot.", cl: "è¿™å¤©å„¿è¦çƒ­ç–¯äº†ã€‚", clp: "zhÃ¨ tiÄnr yÃ o rÃ¨ fÄ“ng le", cle: "It's insanely hot.", cr: "å°±æ˜¯ï¼Œä¸æƒ³å‡ºé—¨ã€‚", crp: "jiÃ¹ shÃ¬ , bÃ¹ xiÇng chÅ« mÃ©n", cre: "Exactly, don't want to go out." },
        { st: "æˆ‘è¦å»ç¡è§‰äº†ã€‚", stp: "wÇ’ yÃ o qÃ¹ shuÃ¬ jiÃ o le", ste: "I'm going to sleep.", cl: "æˆ‘ä¸è¡Œäº†ï¼Œå…ˆçœ¯ä¼šå„¿ã€‚", clp: "wÇ’ bÃ¹ xÃ­ng le , xiÄn mÄ« huÃ¬r", cle: "I'm exhausted, gonna nap.", cr: "å»å§ï¼Œæ™šå®‰ã€‚", crp: "qÃ¹ ba , wÇn Än", cre: "Go ahead, night." },
        { st: "ä½ æœ€è¿‘å¾ˆåŠªåŠ›ã€‚", stp: "nÇ zuÃ¬ jÃ¬n hÄ›n nÇ” lÃ¬", ste: "You work hard lately.", cl: "ä½ æœ€è¿‘å¤ªå·äº†ã€‚", clp: "nÇ zuÃ¬ jÃ¬n tÃ i juÇn le", cle: "You're too 'involution'.", cr: "æ²¡åŠæ³•ï¼Œä¸ºäº†ç”Ÿæ´»ã€‚", crp: "mÃ©i bÃ n fÇ , wÃ¨i le shÄ“ng huÃ³", cre: "No choice, just for life." },
        { st: "æˆ‘ä¸å–œæ¬¢é‚£ä¸ªäººã€‚", stp: "wÇ’ bÃ¹ xÇ huan nÃ  ge rÃ©n", ste: "I don't like him.", cl: "é‚£äººçœŸè®©äººä¸‹å¤´ã€‚", clp: "nÃ  rÃ©n zhÄ“n rÃ ng rÃ©n xiÃ  tÃ³u", cle: "That guy is such a turn-off.", cr: "ç¦»ä»–è¿œç‚¹å„¿ã€‚", crp: "lÃ­ tÄ yuÇn diÇnr", cre: "Stay away from him." },
        { st: "è¿™ä»¶äº‹æƒ…å¾ˆéš¾åŠã€‚", stp: "zhÃ¨ jiÃ n shÃ¬ jing hÄ›n nÃ¡n bÃ n", ste: "This is hard to do.", cl: "è¿™äº‹å„¿æŒºæ£˜æ‰‹çš„ã€‚", clp: "zhÃ¨ shÃ¬r tÇng jÃ­ shÇ’u de", cle: "This is tricky.", cr: "æˆ‘æ‰¾äººæå®šå®ƒã€‚", crp: "wÇ’ zhÇo rÃ©n gÇo dÃ¬ng tÄ", cre: "I'll find someone to fix it." },
        { st: "è¯·å¸®æˆ‘ä¸€ä¸‹ã€‚", stp: "qÇng bÄng wÇ’ yÃ­ xiÃ ", ste: "Please help me.", cl: "æ­æŠŠæ‰‹å‘—ï¼Ÿ", clp: "dÄ bÇ shÇ’u bei", cle: "Give me a hand?", cr: "æ¥å–½ï¼Œç­‰æˆ‘ä¸€ä¸‹ã€‚", crp: "lÃ¡i lou , dÄ›ng wÇ’ yÃ­ xiÃ ", cre: "Coming, wait for me." },
        { st: "é‚£ä¸ªç”µå½±å¾ˆå¥½çœ‹ã€‚", stp: "nÃ  ge diÃ n yÇng hÄ›n hÇo kÃ n", ste: "That movie is good.", cl: "é‚£ç‰‡å­ç»äº†ï¼", clp: "nÃ  piÃ n zi juÃ© le", cle: "That movie is amazing!", cr: "æˆ‘ä¹Ÿè§‰å¾—ï¼Œçœ‹äº†ä¸¤éã€‚", crp: "wÇ’ yÄ› juÃ© de , kÃ n le liÇng biÃ n", cre: "Me too, watched it twice." },
        { st: "æˆ‘ä¸å»äº†ã€‚", stp: "wÇ’ bÃº qÃ¹ le", ste: "I'm not going.", cl: "æˆ‘è¿˜æ˜¯èººå¹³å§ã€‚", clp: "wÇ’ hÃ¡i shi tÇng pÃ­ng ba", cle: "I'll just lie flat/chill.", cr: "çœŸæ‡’ï¼Œèµ°ä¸åŠ¨äº†ï¼Ÿ", crp: "zhÄ“n lÇn , zÇ’u bÃº dÃ²ng le", cre: "So lazy, can't walk?" },
        { st: "ä»–åœ¨è¯´åˆ«äººçš„äº‹ã€‚", stp: "tÄ zÃ i shuÅ biÃ© rÃ©n de shÃ¬", ste: "He is gossiping.", cl: "ä»–åœ¨é‚£å„¿åƒç“œå‘¢ã€‚", clp: "tÄ zÃ i nÃ  r chÄ« guÄ ne", cle: "He's eating popcorn/gossiping.", cr: "æˆ‘ä¹Ÿæƒ³å¬å¬ã€‚", crp: "wÇ’ yÄ› xiÇng tÄ«ng tÄ«ng", cre: "I want to hear too." },
        { st: "ä½ æƒ³åƒä»€ä¹ˆï¼Ÿ", stp: "nÇ xiÇng chÄ« shÃ©n me", ste: "What to eat?", cl: "å®‰æ’ç‚¹å„¿å•¥å¥½åƒçš„ï¼Ÿ", clp: "Än pÃ¡i diÇnr shÃ¡ hÇo chÄ« de", cle: "What tasty food arrange?", cr: "ç«é”…æ€ä¹ˆæ ·ï¼Ÿ", crp: "huÇ’ guÅ zÄ›n me yÃ ng", cre: "How about Hotpot?" },
        { st: "æˆ‘æ²¡æœ‰é’±ã€‚", stp: "wÇ’ mÃ©i yÇ’u qiÃ¡n", ste: "I have no money.", cl: "æˆ‘å£è¢‹æ¯”è„¸å¹²å‡€ã€‚", clp: "wÇ’ kÇ’u dÃ i bÇ liÇn gÄn jÃ¬ng", cle: "Broke as hell.", cr: "æˆ‘ä¹ŸåƒåœŸå¥½å‡ å¤©äº†ã€‚", crp: "wÇ’ yÄ› chÄ« tÇ” hÇo jÇ tiÄn le", cre: "I've been 'eating dirt' too." },
        { st: "ä»–åœ¨éª—ä½ ã€‚", stp: "tÄ zÃ i piÃ n nÇ", ste: "He is lying to you.", cl: "ä»–åœ¨å¿½æ‚ ä½ ã€‚", clp: "tÄ zÃ i hÅ« yu nÇ", cle: "He is fooling you.", cr: "æ—©å°±çœ‹ç©¿ä»–äº†ã€‚", crp: "zÇo jiÃ¹ kÃ n chuÄn tÄ le", cre: "Saw through him long ago." },
        { st: "æ²¡æˆï¼Œæƒ³éƒ½åˆ«æƒ³ã€‚", stp: "mÃ©i xÃ¬ , xiÇng dÅu biÃ© xiÇng", ste: "No chance at all.", cl: "è¿™äº‹å„¿æ‚¬äº†ã€‚", clp: "zhÃ¨ shÃ¬r xuÃ¡n le", cle: "This is up in the air.", cr: "ä¸ä¸€å®šï¼Œå†è¯•è¯•ã€‚", crp: "bÃ¹ yÃ­ dÃ¬ng , zÃ i shÃ¬ shi", cre: "Not sure, try again." },
        { st: "è¿™å·¥ä½œæˆ‘ä¸åšäº†ã€‚", stp: "zhÃ¨ gÅng zuÃ² wÇ’ bÃº zuÃ² le", ste: "I quit this job.", cl: "æˆ‘ä¸å¹²äº†ï¼Œæ’¤ï¼", clp: "wÇ’ bÃ¹ gÃ n le , chÃ¨", cle: "I'm done, withdrawing!", cr: "æœ‰å¿—æ°”ï¼Œå»å“ªå„¿æ··ï¼Ÿ", crp: "yÇ’u zhÃ¬ qÃ¬ , qÃ¹ nÇ r hÃ¹n", cre: "Good for you, where next?" },
        { st: "ä½ è¯´çš„è¯å¾ˆå¯¹ã€‚", stp: "nÇ shuÅ de huÃ  hÄ›n duÃ¬", ste: "You are right.", cl: "çœŸç›¸äº†ï¼Œå®¶äººï¼", clp: "zhÄ“n xiÃ ng le , jiÄ rÃ©n", cle: "That's the truth, fam!", cr: "è¿™å°±æ˜¯ç°å®å•Šã€‚", crp: "zhÃ¨ jiÃ¹ shÃ¬ xiÃ n shÃ­ a", cre: "That's just reality." },
        { st: "ä»–æ˜¯ä¸ªå¥½äººã€‚", stp: "tÄ shÃ¬ ge hÇo rÃ©n", ste: "He is a good man.", cl: "ä»–è¿™äººæŒºé è°±çš„ã€‚", clp: "tÄ zhÃ¨ rÃ©n tÇng kÃ o pÇ” de", cle: "He is quite reliable.", cr: "ç¡®å®ï¼Œå¤§å®¶éƒ½ä¿¡ä»–ã€‚", crp: "quÃ¨ shÃ­ , dÃ  jiÄ dÅu xÃ¬n tÄ", cre: "Indeed, everyone trusts him." },
        { st: "æˆ‘ä¸å»ºè®®ä½ ä¹°ã€‚", stp: "wÇ’ bÃ¹ jiÃ n yÃ¬ nÇ mÇi", ste: "I don't suggest buying.", cl: "å¬æˆ‘çš„ï¼Œèµ¶ç´§é¿é›·ã€‚", clp: "tÄ«ng wÇ’ de , gÇn jÇn bÃ¬ lÃ©i", cle: "Listen to me, avoid it!", cr: "å¥½å§ï¼Œå·®è¯„é‚£ä¹ˆå¤šã€‚", crp: "hÇo ba , chÃ  pÃ­ng nÃ  me duÅ", cre: "Fine, so many bad reviews." },
        { st: "ä»–åœ¨æ‰¿è¯ºç©ºè¯ã€‚", stp: "tÄ zÃ i chÃ©ng nuÃ² kÅng huÃ ", ste: "He's making empty promises.", cl: "ä»–åˆåœ¨ç”»é¥¼äº†ã€‚", clp: "tÄ yÃ²u zÃ i huÃ  bÇng le", cle: "He's painting a pie (lying).", cr: "ä¹ æƒ¯äº†ï¼Œåˆ«å½“çœŸã€‚", crp: "xÃ­ guÃ n le , biÃ© dÃ ng zhÄ“n", cre: "Used to it, don't take it seriously." },
        { st: "è¿™äº‹å„¿æˆ‘ä¸å¼ºæ±‚ã€‚", stp: "zhÃ¨ shÃ¬r wÇ’ bÃ¹ qiÇng qiÃº", ste: "I won't force this.", cl: "éšç¼˜å§ï¼Œæˆ‘å¾ˆä½›ç³»ã€‚", clp: "suÃ­ yuÃ¡n ba , wÇ’ hÄ›n fÃ³ xÃ¬", cle: "Let it be, I'm chill/Zen.", cr: "è¿™ç§å¿ƒæ€æŒºå¥½çš„ã€‚", crp: "zhÃ¨ zhÇ’ng xÄ«n tÃ i tÇng hÇo de", cre: "This mindset is good." },
        { st: "æˆ‘å¾ˆä¸èˆ’æœã€‚", stp: "wÇ’ hÄ›n bÃ¹ shÅ« fu", ste: "I'm not feeling well.", cl: "æˆ‘æ•´ä¸ªäººéƒ½å®äº†ã€‚", clp: "wÇ’ zhÄ›ng gÃ¨ rÃ©n dÅu kuÇ le", cle: "My whole body is falling apart.", cr: "èµ¶ç´§å›å®¶èººç€ã€‚", crp: "gÇn jÇn huÃ­ jiÄ tÇng zhe", cre: "Go home and lie down ASAP." }
    ];

    function initStars() {
        const container = document.getElementById('star-container');
        container.innerHTML = "";
        for(let i=0; i<60; i++) {
            let s = document.createElement('div'); s.className = 'star';
            s.style.setProperty('--angle', Math.random() * 360 + 'deg');
            s.style.animationDuration = Math.random() * 2 + 1 + 's';
            s.style.left = Math.random() * 100 + "%";
            s.style.top = Math.random() * 100 + "%";
            container.appendChild(s);
        }
    }

    function enterApp() {
        const cp = document.getElementById('cover-page');
        cp.style.transform = "translateY(-100%)";
        cp.style.opacity = "0";
        setTimeout(() => { 
            cp.style.display = 'none'; 
            renderStudy(); 
        }, 600);
    }

    function renderPhrase(txt, py) {
        const chars = txt.split('');
        const pys = py.split(' ');
        let html = ""; let pIdx = 0;
        chars.forEach(c => {
            if(/[\u4e00-\u9fa5]/.test(c)) {
                html += `<ruby>${c}<rt>${pys[pIdx] || ''}</rt></ruby>`; pIdx++;
            } else if (c !== " "){
                html += `<span style="font-size:26px; vertical-align:top; line-height:2.4;">${c}</span>`;
            }
        });
        return html;
    }

    function speak(text) {
        window.speechSynthesis.cancel();
        const m = new SpeechSynthesisUtterance(text.replace(/ç‚¹å„¿/g, 'ç‚¹å„¿').replace(/å“ªå„¿/g, 'å“ªå„¿').replace(/äº‹å„¿/g, 'äº‹å„¿'));
        m.lang = 'zh-CN'; m.rate = 0.9;
        window.speechSynthesis.speak(m);
    }

    function showTab(t) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-tab'));
        document.getElementById('view-'+t).classList.add('active');
        document.getElementById('tab-'+t).classList.add('active-tab');
        if(t === 'study') renderStudy();
        if(t === 'list') renderList();
        if(t === 'quiz') initQuiz();
    }

    function renderStudy() {
        const container = document.getElementById('view-study');
        container.innerHTML = "";
        data.forEach((item, i) => {
            const wrap = document.createElement('div');
            wrap.className = 'card-wrap';
            wrap.innerHTML = `
                <div class="box std-box" onclick="speak('${item.st}')">
                    <small style="color:var(--std); font-weight:bold;">[ Textbook ]</small>
                    <div>${renderPhrase(item.st, item.stp)}</div>
                    <span class="eng-sub">${item.ste}</span>
                </div>
                <div class="box col-box" onclick="speak('${item.cl}'); document.getElementById('ra-${i}').style.display='block'">
                    <small style="color:var(--col); font-weight:bold;">[ Real Life ]</small>
                    <div>${renderPhrase(item.cl, item.clp)}</div>
                    <span class="eng-sub">${item.cle}</span>
                </div>
                <div id="ra-${i}" style="display:none;">
                    <button class="btn-reply" onclick="toggleReply(${i}, '${item.cr}')">View Native Reply</button>
                    <div class="box reply-box" id="rb-${i}" onclick="speak('${item.cr}')">
                        <div>${renderPhrase(item.cr, item.crp)}</div>
                        <span class="eng-sub">${item.cre}</span>
                    </div>
                </div>
            `;
            container.appendChild(wrap);
        });
    }

    function toggleReply(i, txt) {
        const el = document.getElementById(`rb-${i}`);
        const hide = window.getComputedStyle(el).display === 'none';
        el.style.display = hide ? 'block' : 'none';
        if(hide) speak(txt);
    }

    function renderList() {
        const container = document.getElementById('view-list');
        container.innerHTML = "<h2 style='text-align:center;'>Bank (30 Items)</h2>";
        data.forEach(item => {
            const row = document.createElement('div');
            row.style = "padding:16px; background:white; margin-bottom:12px; border-radius:18px; box-shadow:0 2px 8px rgba(0,0,0,0.04); cursor:pointer;";
            row.onclick = () => speak(item.cl);
            row.innerHTML = `<strong>${item.cl}</strong> <span style="color:#888; font-size:14px;">(${item.cle})</span>`;
            container.appendChild(row);
        });
    }

    let quizTimer, timeLeft = 30;
    function initQuiz() {
        clearInterval(quizTimer); timeLeft = 30;
        document.getElementById('timer').innerText = "30s";
        nextQuiz();
        quizTimer = setInterval(() => {
            timeLeft--;
            document.getElementById('timer').innerText = timeLeft + "s";
            if(timeLeft <= 0) { clearInterval(quizTimer); alert("Time's up!"); showTab('study'); }
        }, 1000);
    }

    function nextQuiz() {
        const card = document.getElementById('quiz-card');
        const ops = document.getElementById('quiz-options');
        const item = data[Math.floor(Math.random()*data.length)];
        card.innerHTML = `<div class='card-wrap'><h3>Standard:</h3><p style='font-size:24px; color:var(--std);'>${item.st}</p></div>`;
        ops.innerHTML = "";
        let options = [item.cl];
        while(options.length < 3) {
            let r = data[Math.floor(Math.random()*data.length)].cl;
            if(!options.includes(r)) options.push(r);
        }
        options.sort(() => Math.random() - 0.5);
        options.forEach(opt => {
            const b = document.createElement('button');
            b.className = 'btn-reply'; b.style = "margin-bottom:10px; color:black; border-color:#ddd; background:white;";
            b.innerText = opt;
            b.onclick = () => {
                if(opt === item.cl) { b.style.background = "#e8f5e9"; speak(opt); setTimeout(nextQuiz, 600); }
                else { b.style.background = "#ffebee"; }
            };
            ops.appendChild(b);
        });
    }

    window.onload = () => {
        initStars();
    };
</script>
</body>
</html>